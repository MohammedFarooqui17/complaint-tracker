{% extends "master.html" %}




{% block styles %}
<style>
  /* General styles */
  .head-title {
    margin-bottom: 20px;
   
  }





  .head-title h1 {
    font-weight: bold;
    font-size: 35px;
    margin: 0 0 25px 20px;
    color: rgb(23, 23, 88);
  }





  .table-container {
    max-width: 100vw; /* Width for the tables */
    margin: auto; /* Center the tables */
    margin-bottom: 40px; /* Space between tables */
    border-radius: 5px; /* Rounded corners */
    padding: 20px; /* Inner spacing */
    height: auto;
    min-height: 380px;
    box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1); /* Subtle shadow */
    background-color: transparent; /* White background */
    margin-top: 20px;
}




  
  .card-container1 {
    display: flex;
    gap: 20px;
    margin-top: 12px;
    flex-wrap: wrap;
    margin-left: 20px;
  }




  .card:hover {
    transform: translateY(-3px);
    border: 2px solid rgba(255, 255, 255, 0.3);
  }





  .total-complaints { background-color: #2f3d4c; }
  .in-progress { background-color: #967c2e; }
  .done { background-color: #011004; }
  .overdue { background-color: #310408; }
  .resolveoverdue { background-color: #b34b0f; }





  table {
    width: 10%;
    border-collapse: collapse;
    margin-top: 10px;
}






th, td {
  padding: 10px;
  text-align: left;
}





th {
  background-color: white; /* Light gray for header */
  color: #333; /* Dark text for better readability */
  font-weight: bold;
}






  tbody tr:hover {
    background-color: #f1f1f1;
  }





  h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 30px;
  }





  /* Pagination */
  .pagination {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    margin-top: 10px;
  }





  .pagination button {
    padding: 8px 16px;
    border: none;
    background-color: #007BFF;
    color: white;
    cursor: pointer;
    margin-left: 5px;
  }





  .pagination button:disabled {
    background-color: #007BFF;
    cursor: not-allowed;
  }





  #pageInfo {
    margin: 0 10px;
  }





 /* Header styling */
 .header-container {
  display: flex;
  justify-content: space-between; /* Space between elements */
  align-items: center;
  margin-bottom: 20px;
  margin-top: 20px;
}





  .title-filter-container h2 {
    margin: 0; /* Remove default margin */
  }





  .filter-form {
    display: flex;
    gap: 10px; /* Space between inputs and button */
    align-items: center;
  }





  .filter-form input[type="date"] {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }





  .filter-form button {
    padding: 8px 16px;
    border: none;
    background-color: #007BFF;
    color: white;
    cursor: pointer;
    border-radius: 4px;
  }





  .filter-form button:hover {
    background-color: #0056b3;
  }





  form {
    display: flex;
    justify-content: space-between; /* Space between title and input fields */
    align-items: center; /* Vertically center the elements */
    margin-bottom: 20px; /* Space below the form */
}





/* Styling for input fields */
input[type="date"] {
    padding: 10px 15px; /* Add padding for more space inside the input */
    font-size: 16px; /* Increase font size for better readability */
    border: 2px solid #ddd; /* Light border color */
    border-radius: 5px; /* Rounded corners */
    width: 200px; /* Increased width */
    transition: border-color 0.3s ease; /* Smooth transition on hover/focus */
}





/* Focus state for input fields */
input[type="date"]:focus {
    border-color: #007BFF; /* Blue border color on focus */
    outline: none; /* Remove default outline */
}





/* Styling for the filter button */
button[type="submit"] {
    padding: 10px 20px; /* Add padding for better button size */
    background-color: #007BFF; /* Button background color */
    color: white; /* Text color */
    border: none; /* Remove border */
    border-radius: 5px; /* Rounded corners */
    font-size: 16px; /* Increase font size for readability */
    cursor: pointer; /* Change cursor to pointer */
    transition: background-color 0.3s ease; /* Smooth transition on hover */
}





/* Hover effect for the filter button */
button[type="submit"]:hover {
    background-color: #0056b3; /* Darker blue on hover */
}




/* Example color coding for statuses */
.status-pending {
  color: #FF8C00; /* Orange for Pending */
  font-weight: bold;
}




.status-progress {
  color: #8a7605d0; /* Golden Yellow for Work in Progress */
  font-weight: bold;
}




.status-overdue {
  color: #FF4500; /* Red for Overdue */
  font-weight: bold;
}




.status-resolved {
  color: #32CD32; /* Green for Resolved */
  font-weight: bold;
}




.sort-indicator {
  position: absolute;
  right: 10px; /* Space from the right edge */
  top: 50%;
  transform: translateY(-50%); /* Vertically center the icon */
  cursor: pointer;
  display: inline-block; /* Ensure icon aligns properly with text */
}





th span {
  margin-right: 5px; /* Add some space between the heading text and icon */
 
}





.main {
        padding: 10px;
        background: transparent;
        display: grid;
        grid-template-columns: repeat(3, 1fr); 
        gap: 10px;
        min-height: 10vh;
    }




    .card {
        background-color: transparent;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }




    .card h2 {
        font-size: 14px;
        color: #000000;
        margin-bottom: 10px;
        font-weight: 20px;
        font-size: medium;
    }




    .card canvas {
      max-width: 250px;
      max-height: 350px;
    }




    .large-card-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr); 
        margin-top: 20px;
    }




   
    .large-card {
        width: 700px;  
        height: 400px; 
        margin-bottom: 20px; 
        margin-left: 10px;
    }




    .large-card canvas{
      max-width: 550px;
      max-height: 650px;
    }




   
    @media (max-width: 1200px) {
        .main {
            grid-template-columns: repeat(2, 1fr); 
        }
    }




    @media (max-width: 768px) {
    .main {
        grid-template-columns: 1fr;
        gap: 10px; /* Ensure spacing adapts */
        padding: 10px; /* Adjust padding */
    }




    .large-card-container {
        grid-template-columns: 1fr;
    }
}




/* .head-title h1 {
  border-bottom: 2px solid #000000;  
  padding-bottom: 10px;  
} */
</style>



{% endblock %}




{% block content %}
<div class="head-title">
  <h1 style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif; color: #000000;">Dashboard</h1>
</div>




<!-- Display error message if it exists -->
{% if error_message %}
    <div style="color: red;">
        <strong>Error:</strong> {{ error_message }}
    </div>
{% endif %}




<div class="main">
  <!-- Card with Doughnut Chart -->
  <div class="card">
    <h2>Total Complaints by Location</h2>
    <canvas id="locationDoughnut" width="260" height="380"
      style="display: block; box-sizing: border-box; height: 400px; width: 400px;"></canvas>
  </div>




  <!-- Card with Pie Chart -->
  <div class="card">
    <h2>Total Complaints by Status</h2>
    <canvas id="statusPie"></canvas>
    <!-- <canvas id="statusPie" width="420" height="480" style="display: block;box-sizing: border-box;height: 250px;width: 220px;"></canvas> -->
  </div>




  <div class="card">
    <h2>Total Complaints by Department</h2>
    <canvas id="stateComplaintChart"></canvas>
  </div>
</div>




<!-- Large Cards Container -->
<div class="large-card-container">
  <div class="card large-card">
    <h2>Total Complaint Categories</h2>
    <canvas id="categoryChart"></canvas>
  </div>




  <div class="card large-card">
    <h2>Total Resolved Complains By Location</h2>
    <canvas id="resolverPerformanceChart"></canvas>
  </div>
</div>





<div class="table-container">
  <div class="header-container">
    <h2>Last 7 Days Complaint</h2>
    <form method="get" action="{% url 'superadmindashboard' %}" class="filter-form">
      <label for="from_date">From:</label>
      <input type="date" id="from_date" name="from_date" value="{{ from_date }}">




      <label for="to_date">To:</label>
      <input type="date" id="to_date" name="to_date" value="{{ to_date }}">




      <button type="submit">Filter</button>
    </form>
  </div>



  <div style="overflow-x: auto; width: 100%; min-height: 350px; margin-top:10px;  ">
    <table id="complaintTable" class="display" style="width: 100%; table-layout: fixed;">
      <thead>
        <tr>
          <th>Name</th>
          <th>Dept</th>
          <th>Location</th>
          <th>Type</th>
          <th>Issue Date</th>
          <th>Original Due Date</th>
          <th>Revised Due Date</th>
          <th>Reason</th>
          <th>Desc</th>
          <th>Status</th>
          <th>Resolved By</th>
          <th>Resolution</th>
          <th>Resolved At</th>
          <th>Resolution Time</th>
        </tr>
      </thead>
      <tbody>
        {% for report in reports %}
          <tr>
            <td>{{ report.name }}</td>
            <td>{{ report.department }}</td>
            <td>{{ report.location }}</td>
            <td>{{ report.complaint_type }}</td>
            <td>{{ report.date }}</td>
            <td>{{ report.due_date }}</td>
            <td>{{ report.updated_due_date }}</td>
            <td>{{ report.reason }}</td>
            <td>{{ report.description }}</td>
            <td>
              <span class="{% if report.status|lower == 'pending' %}status-pending
                            {% elif report.status|lower == 'work in progress' %}status-progress
                            {% elif report.status|lower == 'overdue' %}status-overdue
                            {% elif report.status|lower == 'resolved' %}status-resolved{% endif %}">
                 <i class="{% if report.status|lower == 'pending' %}fas fa-clock{% elif report.status|lower == 'work in progress' %}fas fa-spinner{% elif report.status|lower == 'overdue' %}fas fa-exclamation-triangle{% elif report.status|lower == 'resolved' %}fas fa-check-circle{% endif %}"></i>
                <strong>{{ report.status }}</strong>
              </span>
            </td>
            <td>{{ report.resolved_by }}</td>
            <td>{{ report.resolution }}</td>
            <td>{{ report.updated_at }}</td>
            <td>{{ report.tat }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>



{% endblock %}



{% block script %}



<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>



<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>



<!-- DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">



<!-- DataTables Buttons CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.dataTables.min.css">




<!-- DataTables Buttons JS -->
<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>



<!-- JSZip for Excel export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>



<!-- PDFMake for PDF export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.68/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.68/vfs_fonts.js"></script>



<script>
  $(document).ready(function () {
    // Initialize DataTables for complaintTable
    $('#complaintTable').DataTable({
        paging: true,
        searching: true,
        ordering: true,
        responsive: true,
        lengthMenu: [3,5, 10, 25, 50],
        columnDefs: [
            { orderable: false, targets: -1 }
        ],
        language: {
            search: "Search Complaint:",
            lengthMenu: "Display _MENU_ records per page",
            zeroRecords: "No complaints found",
            info: "Showing _START_ to _END_ of _TOTAL_ complaints",
            infoEmpty: "No records available",
            paginate: {
                previous: "Previous",
                next: "Next"
            }
        },
      
       
        initComplete: function() {
            // Apply custom CSS styles to move the search box label and input up
            $('#complaintTable_filter label').css({
                'position': 'relative',
                'top': '3px',  // Adjust the value as needed to move the search box up
                'left': '0'
            });
            $('#complaintTable_filter input').css({
                'position': 'relative',
                'top': '-3px'  // Adjust the value as needed to move the search box up
            });
        }
    });
  });
</script>



<script type="text/javascript">
  // This script will force a redirect to login if the user navigates back
  if (!sessionStorage.getItem('loggedIn')) {
    window.location.href = "{% url 'login' %}";
  }
</script>



<script>



  var locations = {{ locations|safe }};  // Django context for locations
  var locationCounts = {{ location_counts|safe }};  // Django context for complaint counts
  
  // Doughnut Chart for Complaints by Location
  var ctxLocation = document.getElementById('locationDoughnut').getContext('2d');
  
  new Chart(ctxLocation, {
    type: 'doughnut',
    data: {
      labels: locations,  // Dynamically use locations as labels
      datasets: [{
        label: 'Complaints by Location',
        data: locationCounts,  // Dynamically use complaint counts
        backgroundColor: [
        'rgba(158, 169, 235, 0.7)',  
        'rgba(130, 136, 229, 0.7)',  
        'rgba(141, 121, 255, 0.7)',  
        'rgba(135, 206, 235, 0.7)',    
          'rgba(0, 83, 179, 0.7)', 
        'rgba(135, 206, 235, 0.9)',  
        'rgba(123, 104, 238, 0.9)', 
        'rgba(30, 144, 255, 0.9)',  
        'rgba(70, 130, 180, 0.9)', 
        'rgba(65, 105, 225, 0.9)'  
        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 182, 193, 1)',
          'rgba(201, 203, 207, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: true,
      aspectRatio: 1,
      plugins: {
        legend: {
          display: true,
          position: 'bottom',
        },
        tooltip: {
          callbacks: {
            label: function (tooltipItem) {
              return 'Complaints: ' + tooltipItem.raw;  // Format the tooltip text
            }
          }
        },
        datalabels: {
          formatter: function (value, context) {
            // Display complaints and location names
            var label = context.chart.data.labels[context.dataIndex];
            return label + ': ' + value ;
          },
          color: 'black',  // Label text color
          font: {
            weight: 'bold',
            size: 15,  // Font size for the labels
            family: 'Roboto'
          },
          align: 'center',  // Align the labels to the center
          anchor: 'center',  // Anchor the labels to the center
          rotation : 50,
          padding:0,
          textAlign:'center',
          offset: 10,  // Add a slight offset for better readability
          clamp: true  // Ensure text doesn't overflow outside the doughnut
        }
      }
    },
    plugins: [ChartDataLabels],  // Enable the datalabels plugin
  });



// Pie Chart for Complaints by Status
var statuses = {{ statuses|safe }};
var statusCounts = {{ status_counts|safe }};



// Pie Chart for Complaints by Status
var ctxStatus = document.getElementById('statusPie').getContext('2d');
new Chart(ctxStatus, {
  type: 'pie',
  data: {
    labels: statuses,  // Dynamic labels from Django context
    datasets: [{
      label: 'Complaints by Status',
      data: statusCounts,  // Dynamic data from Django context
      backgroundColor: [
        
      'rgba(154, 162, 10000, 1)',  
        'rgba(130, 120, 20000, 1)',  
        'rgba(131, 151, 300, 1)',  
        'rgba(135, 206, 235, 1)',
        'rgba(30, 144, 255, 1)',
        'rgba(123, 104, 238, 1)',
        'rgba(65, 105, 225, 1)',
        'rgba(176, 224, 230, 1)'
      ],
      borderColor: [
        'rgba(255, 299, 132, 1)',
        'rgba(175, 292, 192, 1)',
        'rgba(154, 262, 235, 1)',
        'rgba(255, 82, 193, 1)',
        'rgba(201, 203, 207, 1)'
      ],
      borderWidth: 1
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: true,
    aspectRatio: 1,
    plugins: {
      legend: {
        display: true,
        position: 'bottom',
      },
      tooltip: {
        callbacks: {
          label: function(tooltipItem) {
            return 'Complaints: ' + tooltipItem.raw;  // Format the tooltip text
          }
        }
      },
      datalabels: {
        formatter: function(value, context) {
          // Capitalize the first letter of the label and display the count
          var label = context.chart.data.labels[context.dataIndex];
          var capitalizedLabel = label.charAt(0).toUpperCase() + label.slice(1); // Capitalize the first letter
          return label+ ":"+ value;
        },
        color: 'black',  // Label text color
        font: {
          weight: 'bold',
          size: 15,  // Font size for the labels
          family: 'Roboto'
        },
        align: 'center',  // Align the labels to the center
        anchor: 'center',  // Anchor the labels to the center
        clamp: true,  // Ensure text doesn't overflow outside the pie
        offset: 10  // Add a slight offset for better readability
      }
    }
  },
  plugins: [ChartDataLabels],  // Enable the datalabels plugin
});



var departments = {{ departments|safe }};  // List of department names
var departmentCounts = {{ department_counts|safe }};  // List of complaint counts




var ctxLocation = document.getElementById('stateComplaintChart').getContext('2d');
new Chart(ctxLocation, {
  type: 'doughnut',
  data: {
    labels: departments, // Dynamic department labels
    datasets: [{
      label: 'Complaints by Department',
      data: departmentCounts, // Dynamic data for complaint counts
      backgroundColor: [
      'rgba(154, 162, 235, 0.7)',  
        'rgba(130, 136, 229, 0.7)',  
        'rgba(141, 121, 255, 0.7)',  
        'rgba(135, 206, 235, 0.7)',
        'rgba(30, 144, 255, 0.7)',
        'rgba(150, 99, 190, 0.7)',  // Arctic Indigo
        'rgba(95, 158, 160, 0.7)', // Cerulean Deep
        'rgba(0, 128, 128, 0.7)',   // Obsidian Blue
        'rgba(70, 130, 180, 0.7)', // Frosted Sapphire
        'rgba(224, 255, 255, 0.7)' // Aqua Horizon
      ],
      borderColor: [
        'rgba(41, 155, 99, 1)',
        'rgba(54, 162, 235, 1)',
        'rgba(255, 206, 86, 1)',
        'rgba(120, 46, 139, 1)',
        'rgba(255, 99, 132, 1)'
      ],
      borderWidth: 1
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: true,
    aspectRatio: 1,
    plugins: {
      legend: {
        display: true,
        position: 'bottom',
      },
      datalabels: {
        formatter: function(value, context) {
          // Display department name and complaint count
          var label = context.chart.data.labels[context.dataIndex];
          return label + ' : ' + value;
        },
        color: 'black',  // Label text color
        font: {
          weight: 'bold',
          size: 13,  // Font size for the labels
          family: 'Roboto'
        },
        align: 'center',  // Align the labels to the center
        anchor: 'center',  // Anchor the labels to the center



        offset: 10,  // Add a slight offset for better readability
        clamp: true  // Ensure text doesn't overflow outside the doughnut
      }
    }
  },
  plugins: [ChartDataLabels],  // Enable the datalabels plugin
});



var categories = {{ categories|safe }};
var category_counts = {{ category_counts|safe }};



// Ensure all counts are whole numbers (integers)
category_counts = category_counts.map(function(count) {
  return Math.round(count);  // Round to the nearest integer
});



// Define colors for all categories
const backgroundColors = [
  'rgba(60, 120, 150, 1)', // Aqua Horizon
  'rgba(0, 51, 102, 1)',   // Dark Blue
  'rgba(70, 130, 180, 1)', // Steel Blue
  'rgba(85, 174, 213, 1)', // Sky Blue
  'rgba(128, 128, 128, 1)', // Grey (additional colors if needed)
];
const borderColors = [
  'rgba(75, 192, 192, 1)',
  'rgba(255, 159, 64, 1)',
  'rgba(54, 162, 235, 1)',
  'rgba(153, 102, 255, 1)',
  'rgba(169, 169, 169, 1)', // Grey border (additional colors if needed)
];



// Adjust colors to match the number of categories dynamically
const adjustedBackgroundColors = Array(categories.length)
  .fill(backgroundColors)
  .flat()
  .slice(0, categories.length);
const adjustedBorderColors = Array(categories.length)
  .fill(borderColors)
  .flat()
  .slice(0, categories.length);



const categoryChartCtx = document.getElementById('categoryChart').getContext('2d');
new Chart(categoryChartCtx, {
  type: 'bar',
  data: {
    labels: categories,
    datasets: [{
      label: 'Number of Complaints',
      data: category_counts,
      backgroundColor: adjustedBackgroundColors,
      borderColor: adjustedBorderColors,
      borderWidth: 1
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false, // To allow scrolling and control the height/width
    plugins: {
      legend: {
        display: true,
        position: 'bottom',
        labels: {
          generateLabels: function(chart) {
            return chart.data.labels.map(function(label, index) {
              return {
                text: label,
                fillStyle: chart.data.datasets[0].backgroundColor[index],
                strokeStyle: chart.data.datasets[0].borderColor[index],
                lineWidth: chart.data.datasets[0].borderWidth,
              };
            });
          },
          font: {
            size: 14,
            family: 'Roboto',
            weight: 'bold',
          }
        }
      },
      tooltip: {
        callbacks: {
          label: function (tooltipItem) {
            return tooltipItem.raw + ' Complaints';
          }
        }
      },
      datalabels: {
        display: true,
        align: 'center',
        formatter: function(value, context) {
          return value;
        },
        color: 'white',
        font: {
          weight: 'bold',
          size: 13,
          family: 'Roboto'
        }
      }
    },
    scales: {
      x: {
        title: {
          display: true,
          text: 'Categories'
        },
        ticks: {
          autoSkip: true,  // Skip labels if they overlap
        },
        grid: {
          display: true,
          borderColor: '#ddd'
        },
        min: 0,
        max: categories.length, // Set max value if you want to limit the visible area
        offset: true
      },
      y: {
        beginAtZero: true,
        title: {
          display: true,
          text: 'Number of Complaints'
        },
        grid: {
          display: true,
          borderColor: '#ddd'
        },
        min: 0,
        max: Math.max(...category_counts) * 1.1, // Adjust max value to fit the highest value in the dataset
        ticks: {
          stepSize: 1, // Set the step size to 1, ensuring only whole numbers are displayed
          callback: function(value) {
            return Number.isInteger(value) ? value : ''; // Show only whole numbers
          }
        }
      }
    },
    animation: {
      duration: 0, // Disable animations for faster scrolling
    }
  },
  plugins: [ChartDataLabels]
});




var resolvers = {{ locations2|safe }};
var resolver_counts = {{ location_counts2|safe }};



const resolverPerformanceCtx = document
  .getElementById('resolverPerformanceChart')
  .getContext('2d');



new Chart(resolverPerformanceCtx, {
  type: 'bar',
  data: {
    labels: resolvers, 
    datasets: [
      {
        label: 'Complaints Resolved',
        data: resolver_counts, 
        backgroundColor: [
          'rgba(0, 123, 255, 1)',   
          'rgba(0, 153, 255, 1)',  
          'rgba(4, 20, 38, 1)',   // Obsidian Blue
          'rgba(40, 60, 100, 1)', // Frosted Sapphire
          'rgba(60, 120, 150, 1)' // Aqua Horizon
        ],
        borderColor: [
          'rgba(54, 162, 235, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(255, 159, 64, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(150, 100, 250, 1)',
        ],
        borderWidth: 1,
      },
    ],
  },
  options: {
    indexAxis: 'y', // Horizontal bar chart
    responsive: true,
    plugins: {
      legend: {
        display: false,
      },
      tooltip: {
        callbacks: {
          label: function (tooltipItem) {
            return   tooltipItem.raw + ' Complaints'; 
          },
        },
      },
      datalabels: {
        display: true,  // Display the data labels
        align: 'center', // Align the labels at the center of each bar
        formatter: function(value, context) {
          return  value;  // Format the label to show 'Complaints' with the number
        },
        color: 'white',  // Set the label color (white)
        font: {
          weight: 'bold',  // Bold font for better visibility
          size: 15,  // Adjust font size if needed
          family: 'Roboto'
        }
      }
    },
    scales: {
      x: {
        beginAtZero: true,
        title: {
          display: true,
          text: 'Number of Complaints Resolved', 
        },
      },
      y: {
        title: {
          display: true,
          text: 'Locations', 
        },
      },
    },
  },
  plugins: [ChartDataLabels]  // Register the plugin
});
</script>




{% endblock %}
